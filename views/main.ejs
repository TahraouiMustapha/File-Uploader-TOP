<html>
    <head>
        <title>dome</title>
    </head>
    <body>
        <%-include('partials/header')%>
        
        <%if (locals.user) {%>
            <button id="newFileBtn">New file</button>
            <button id="newFolderBtn">New folder</button>

            <div>
                <p><%=user.username%></p>
                <%if(locals.userFiles) {%>
                    <ul>
                        <%userFiles.forEach(file => {%>
                            <li><%= `${file.name}, ${file.size}, ${file.createdDate}` %></li>
                        <%})%>                            
                    </ul>
                <%} else {%>
                    <p>Create a new folder to get started</p>    
                <%}%>                    
            </div>

        <%}%>     
        
        <!-- uplaod file form -->
        <dialog id="newFileDialog">
            <form action="/files/new-file" method="post" enctype="multipart/form-data">
                <button type="button" id="exitNewFileBtn">X</button>
                <input type="file" name="new-file">
                <button type="submit">Upload</button>
            </form>
        </dialog>

        <!-- new folder form -->
        <dialog id="newFolderDialog">
            <form action="/files/new-folder" method="post">
                <button type="button" id="exitNewFolderBtn">X</button>
                <p>
                    <label for="folderName">Name</label>
                    <input type="text" id="folderName" name="folderName">
                </p>

                <button type="submit">Create Folder</button>
            </form>
        </dialog>

    </body>
    <script>
        const newFileBtn = document.getElementById('newFileBtn');
        const newFileDialog = document.querySelector('#newFileDialog');
        const exitNewFileBtn = document.getElementById('exitNewFileBtn');


        const newFolderBtn = document.querySelector('#newFolderBtn');
        const newFolderDialog = document.querySelector('#newFolderDialog');
        const exitNewFolderBtn = document.querySelector('#exitNewFolderBtn')
        const folderNameInput = document.querySelector('input[name = \"folderName\"]')

 
        if(newFileBtn){
            newFileBtn.addEventListener('click', ()=> {
            newFileDialog.showModal()
            })
        }

        if(newFolderBtn){
            newFolderBtn.addEventListener('click', ()=> {
            newFolderDialog.showModal()
            })
        }

        exitNewFileBtn.addEventListener('click', ()=> {
            newFileDialog.close()
        })

        exitNewFolderBtn.addEventListener('click', ()=> {
            folderNameInput.value = ''
            newFolderDialog.close()
        })

    </script>
</html>